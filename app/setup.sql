CREATE TABLE IF NOT EXISTS `category` (  `id` int(10) NOT NULL AUTO_INCREMENT,  `id_parent` int(10) NOT NULL DEFAULT '0',  `title` varchar(255) NOT NULL,  `desc` text,  `sort` int(10) NOT NULL,  `visible` tinyint(1) NOT NULL DEFAULT '1',  PRIMARY KEY (`id`)) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=9 ;
TRUNCATE TABLE `category`;
INSERT INTO `category` (`id`, `id_parent`, `title`, `desc`, `sort`, `visible`) VALUES(1, 0, '.информация', '<h4>Здесь собрана вся информация о сайте, на котором&nbsp;вы сейчас&nbsp;находитесь.</h4>', 2, 1),(4, 1, 'Жизнь сайта', '<h4>О том что нового произошло в нашем уютном пространстве.</h4>', 4, 1),(5, 0, 'бл*госсфера', '<h4>Кое какие записи</h4>', 1, 1),(6, 1, 'Команда', '<h4>TestR в лицах.</h4>', 3, 1),(8, 0, 'Не для печати', 'Служебная категория', 3, 0);
CREATE TABLE IF NOT EXISTS `comment` (  `id` int(10) NOT NULL AUTO_INCREMENT,  `id_content` int(10) NOT NULL,  `id_user` int(10) NOT NULL,  `message` text NOT NULL,  `created` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,  PRIMARY KEY (`id`),  KEY `FKcomment112868` (`id_user`),  KEY `FKcomment820416` (`id_content`)) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=14 ;
TRUNCATE TABLE `comment`;
INSERT INTO `comment` (`id`, `id_content`, `id_user`, `message`, `created`) VALUES(13, 8, 1, 'Приветствую всех зашедших!', '2013-08-24 17:40:34');
CREATE TABLE IF NOT EXISTS `config` (  `id` int(10) NOT NULL AUTO_INCREMENT,  `module` varchar(255) NOT NULL,  `variable` varchar(255) NOT NULL,  `desc` text NOT NULL,  `value` text NOT NULL,  `default` varchar(255) DEFAULT NULL,  `options` text,  PRIMARY KEY (`id`),  UNIQUE KEY `module` (`module`,`variable`)) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=21 ;
TRUNCATE TABLE `config`;
INSERT INTO `config` (`id`, `module`, `variable`, `desc`, `value`, `default`, `options`) VALUES(2, 'init', 'language', 'Язык интерфейса', 'ru', 'ru', '{"ru":"Русский", "en":"Английский"}'),(3, 'init', 'charset', 'Кодировка страницы', 'utf-8', 'utf-8', NULL),(4, 'init', 'date_format', 'Формат отображения даты', 'd.m.Y', 'd.m.Y', NULL),(5, 'init', 'datetime_format', 'Формат отображения даты и времени', 'd.m.Y H:i', 'd.m.Y H:i', NULL),(6, 'init', 'site_name', 'Название сайта', 'TestR', 'TestR', NULL),(7, 'init', 'site_slogan', 'Подпись для сайта (слоган)', 'Rey''s Test', 'Rey''s Test', NULL),(8, 'init', 'metakeys', 'Ключевые слова', 'keys', NULL, NULL),(9, 'init', 'metadesc', 'Описание сайта', 'description', NULL, NULL),(10, 'init', 'admin_mail', 'E-mail администратора', 'admin@exapmle.com', NULL, NULL),(11, 'init', 'copyright', 'Подпись внизу страницы', 'Rey''s Systems 2013 - TestR v1.0', NULL, NULL),(12, 'user', 'count_list_user', 'Количество пользователей в списке поиска по имени', '7', '5', NULL),(17, 'category', 'inner_contents', 'Показывать материалы которые находятся во внутренних категориях', '0', '0', '{&quot;1&quot;: &quot;Да&quot;, &quot;0&quot;: &quot;Нет&quot;}'),(18, 'category', 'limit_contents', 'Количество материалов на странице', '10', '20', NULL),(19, 'category', 'limit_intro', 'Количество символов в превью, если отсутствует разрыв страницы', '100', '100', ''),(20, 'content', 'hero_id', 'Укажите id материала содержимое которого будет отображено на главной странице', '10', '0', '');
CREATE TABLE IF NOT EXISTS `content` (  `id` int(10) NOT NULL AUTO_INCREMENT,  `id_user` int(10) NOT NULL,  `id_category` int(10) NOT NULL,  `title` varchar(255) NOT NULL,  `created` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,  `desc` mediumtext NOT NULL,  `photos` text,  `view` int(10) NOT NULL,  PRIMARY KEY (`id`),  KEY `FKcontent980808` (`id_user`),  KEY `FKcontent739985` (`id_category`)) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=12 ;
TRUNCATE TABLE `content`;
INSERT INTO `content` (`id`, `id_user`, `id_category`, `title`, `created`, `desc`, `photos`, `view`) VALUES(8, 1, 1, 'Что это?', '2013-08-19 00:15:17', '<h4>Это индивидуальный проект за авторством <a href="/main/content/get/9" target="_blank" rel="nofollow" title="Link: /main/content/get/9">Rey</a>.&nbsp;Почти CMS для реализации простых идей.</h4>@pagebreak<h3>Что тут уже есть?</h3><ol><li>Пользовательский функционал - регистрация, разделение прав, профиль для отражения некоторой информации о себе,&nbsp;отправка сообщений другим пользователям, комментирование новостей.</li><li>Контент - работа с текстовыми материалами&nbsp;предусматривает наличие небольшого wysiwyg-редкатора и возможность оставлять отзывы к каждой новости. Так же имеется некоторые плюшки в виде создании фотоленты для новости.</li><li>Категории - для тематического разделения контента реализовано в виде иерархии.</li><li>Административная панель - и соответствующий&nbsp;доступ включает в себя управление и настройку системы управления сайтом.</li></ol>Что использовалось для ее создания <a href="/main/content/get/11" target="_blank" rel="nofollow">читайте здесь</a>.<br><br>', 'null', 302),(9, 1, 6, 'Капитан звездного корабля', '2013-08-19 05:41:41', 'Связаться с автором системы вы можете через следующие контакты.<br>@pagebreak<br><ul><li>email: rey.8d01@yandex.ru</li><li>icq: 207772947</li><li>jabber: rey.8d01@jabber.ru</li></ul>', 'null', 22),(10, 1, 8, 'TestR', '2013-08-24 04:47:58', '&lt;p&gt;Добро пожаловать в проект имени его автора! Хотите узнать что это?&lt;/p&gt;\n&lt;p&gt;&lt;a class="btn btn-primary btn-large" href=''main/content/get/8''&gt;Хочу »&lt;/a&gt;&lt;/p&gt;', 'null', 55),(11, 1, 1, 'CMS изнутри', '2013-08-24 15:23:56', 'На чем построена система и что было использовано для ее разработки?<br>@pagebreak<br><u>Серверная часть:</u><br><ul><li>Система написана на языке <b>php 5.3</b> с иcпользованием микрофреймворка <b>Fat-Free 3</b> (так же известный как f3);</li><li>В качестве субд используется <b>MariaDB 10</b> (форк MySQL);</li><li>Система полностью работает на веб сервере <b>nginx</b> (и никакого apache на стороне back-end);</li></ul><u>Клиентская часть:</u><br><ul><li>Интерфейс класcический <b>Twitter Bootstrap 2</b>;</li><li>Для анимации, подгрузки данных и прочих вещей&nbsp;<b>jQuery 1.9</b>;</li><li>Для ajax загрузки файлов используется <b>jquery.fileupload.js</b>;</li><li>Работу с фотолентой и отображением загруженных фотографий организуют библиотеки <b>colorbox</b> и <b>gp-gallery</b>;</li><li>Визуальным редактором контента является <b>wysihtml5</b>;</li></ul>', 'null', 13);
CREATE TABLE IF NOT EXISTS `data_profile` (  `id_user` int(10) NOT NULL,  `id_profile` int(10) NOT NULL,  `value` text,  PRIMARY KEY (`id_user`,`id_profile`),  KEY `FKdata_profi883209` (`id_user`),  KEY `FKdata_profi901236` (`id_profile`)) ENGINE=InnoDB DEFAULT CHARSET=utf8;
TRUNCATE TABLE `data_profile`;
CREATE TABLE IF NOT EXISTS `message` (  `id` int(10) NOT NULL AUTO_INCREMENT,  `id_owner` int(10) NOT NULL,  `id_sender` int(10) NOT NULL,  `id_recipient` int(10) NOT NULL,  `message` text NOT NULL,  `date` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,  `showed` tinyint(1) NOT NULL DEFAULT '0',  `deleted` tinyint(1) NOT NULL DEFAULT '0',  PRIMARY KEY (`id`),  KEY `FKmessage8968` (`id_owner`),  KEY `FKmessage252758` (`id_sender`),  KEY `FKmessage970901` (`id_recipient`)) ENGINE=InnoDB DEFAULT CHARSET=utf8 AUTO_INCREMENT=1 ;
TRUNCATE TABLE `message`;
CREATE TABLE IF NOT EXISTS `navigate` (  `id` int(10) NOT NULL AUTO_INCREMENT,  `id_parent` int(10) NOT NULL DEFAULT '0',  `id_group` int(11) NOT NULL DEFAULT '3',  `type` varchar(255) NOT NULL DEFAULT 'link',  `title` varchar(255) DEFAULT NULL,  `__module` varchar(255) DEFAULT NULL,  `__function` varchar(255) DEFAULT NULL,  `__id` int(10) DEFAULT NULL,  `sort` int(10) NOT NULL,  PRIMARY KEY (`id`)) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=18 ;
TRUNCATE TABLE `navigate`;
INSERT INTO `navigate` (`id`, `id_parent`, `id_group`, `type`, `title`, `__module`, `__function`, `__id`, `sort`) VALUES(3, 0, 3, 'link', 'Мои ссылки', 'main', 'get', 0, 6),(5, 3, 3, 'link', 'Мой профиль', 'user', 'mine', 0, 7),(10, 3, 3, 'link', 'Мои сообщения', 'user', 'list_talk', 0, 8),(12, 0, 2, 'link', 'Управление', 'admin', 'index', 0, 9),(13, 0, 5, 'link', 'О нас', 'main', 'index', 0, 1),(14, 13, 5, 'link', 'Лента', 'category', 'get', 1, 5),(15, 13, 5, 'divider', 'Разделительная черта', 'main', 'index', 0, 4),(16, 13, 5, 'link', 'Что это?', 'content', 'get', 8, 2),(17, 13, 5, 'link', 'Кто это?', 'content', 'get', 9, 3);
CREATE TABLE IF NOT EXISTS `profile` (  `id` int(10) NOT NULL AUTO_INCREMENT,  `field` varchar(255) NOT NULL,  `type` varchar(255) NOT NULL,  `maxlen` int(10) NOT NULL,  `sort` int(10) NOT NULL,  `comment` varchar(255) DEFAULT NULL,  PRIMARY KEY (`id`)) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=2 ;
TRUNCATE TABLE `profile`;
INSERT INTO `profile` (`id`, `field`, `type`, `maxlen`, `sort`, `comment`) VALUES(1, 'icq', 'number', 15, 1, 'Номер вашей аськи');
CREATE TABLE IF NOT EXISTS `user` (  `id` int(10) NOT NULL AUTO_INCREMENT,  `id_group` int(10) NOT NULL DEFAULT '3',  `name` varchar(255) NOT NULL,  `pass` varchar(255) NOT NULL,  `avatar` varchar(255) DEFAULT NULL,  `ip` varchar(255) NOT NULL,  `register` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,  `email` varchar(255) DEFAULT NULL,  PRIMARY KEY (`id`),  UNIQUE KEY `name` (`name`)) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=2 ;
TRUNCATE TABLE `user`;
INSERT INTO `user` (`id`, `id_group`, `name`, `pass`, `avatar`, `ip`, `register`, `email`) VALUES(1, 1, 'admin', '$2y$10$l1i2KiYsp.ELYhzyt0za4Od4oTG4BhX/2PRhHSpNw/.sC98dVPtKa', '', '127.0.0.1', NULL, NULL);
ALTER TABLE `comment`  ADD CONSTRAINT `FKcomment112868` FOREIGN KEY (`id_user`) REFERENCES `user` (`id`),  ADD CONSTRAINT `FKcomment820416` FOREIGN KEY (`id_content`) REFERENCES `content` (`id`);
ALTER TABLE `content`  ADD CONSTRAINT `FKcontent739985` FOREIGN KEY (`id_category`) REFERENCES `category` (`id`),  ADD CONSTRAINT `FKcontent980808` FOREIGN KEY (`id_user`) REFERENCES `user` (`id`);
ALTER TABLE `data_profile`  ADD CONSTRAINT `FKdata_profi883209` FOREIGN KEY (`id_user`) REFERENCES `user` (`id`),  ADD CONSTRAINT `FKdata_profi901236` FOREIGN KEY (`id_profile`) REFERENCES `profile` (`id`);
ALTER TABLE `message`  ADD CONSTRAINT `FKmessage252758` FOREIGN KEY (`id_sender`) REFERENCES `user` (`id`),  ADD CONSTRAINT `FKmessage8968` FOREIGN KEY (`id_owner`) REFERENCES `user` (`id`),  ADD CONSTRAINT `FKmessage970901` FOREIGN KEY (`id_recipient`) REFERENCES `user` (`id`);
